"use strict";

// AMQP log test message at an interval until killed.

const _ = require('lodash');
const fs = require('fs');
const log = require('../');
const path = require('path');

var options = {
    amqp: { enable: true, format: 'text' },
    console: { enable: true, color: true, timestamp: true, stderr: true },
};
try {
    options = _.defaultsDeep(options, JSON.parse(fs.readFileSync(path.join(__dirname, 'ssi-logger.conf')).toString()));
} catch (err) {
    console.error(err);
}

process.title = "no_hyphens"

log.configureTransports(options);
//require('@ssi/uncaught-exception');

const obj = {
    hello: "world",
    child: {
        world: "peace",
        child: {
            bang: "war",
            child: null
        }
    }
};

const mylog = log.defaults({ request_id: '7423927D-6F4E-43FE-846E-C474EA3488A3' }, 'foobar');

mylog.info("Starting interval timer.");
const intervalHandle = setInterval(function () {
    mylog.notice("Ying-tong Iddle-I-Po!", obj);
}, 47000);
